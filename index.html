<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="style.css">
        <script src="https://xemantic.github.io/shader-web-background/dist/shader-web-background.min.js"></script>
        <script type="x-shader/x-fragment" id="image">
            // Author: bradjamesgrant
            // Source: https://www.shadertoy.com/view/tsXBzS
            // Title:  Fractal Pyramid

            precision highp float;

            uniform vec2  iResolution;
            uniform float iTime;
            // ... other needed uniforms
            
            // -- Paste your Shadertoy code here:
            vec3 palette(float d){
                return mix(vec3(0.2,0.7,0.9),vec3(1.,0.,1.),d);
            }

            vec2 rotate(vec2 p,float a){
                float c = cos(a);
                float s = sin(a);
                return p*mat2(c,s,-s,c);
            }

            float map(vec3 p){
                for( int i = 0; i<8; ++i){
                    float t = iTime*0.2;
                    p.xz =rotate(p.xz,t);
                    p.xy =rotate(p.xy,t*1.89);
                    p.xz = abs(p.xz);
                    p.xz-=.5;
                }
                return dot(sign(p),p)/5.;
            }

            vec4 rm (vec3 ro, vec3 rd){
                float t = 0.;
                vec3 col = vec3(0.);
                float d;
                for(float i =0.; i<64.; i++){
                    vec3 p = ro + rd*t;
                    d = map(p)*.5;
                    if(d<0.02){
                        break;
                    }
                    if(d>100.){
                        break;
                    }
                    //col+=vec3(0.6,0.8,0.8)/(400.*(d));
                    col+=palette(length(p)*.1)/(400.*(d));
                    t+=d;
                }
                return vec4(col,1./(d*100.));
            }
            void mainImage( out vec4 fragColor, in vec2 fragCoord )
            {
                vec2 uv = (fragCoord-(iResolution.xy/2.))/iResolution.x;
                vec3 ro = vec3(0.,0.,-50.);
                ro.xz = rotate(ro.xz,iTime);
                vec3 cf = normalize(-ro);
                vec3 cs = normalize(cross(cf,vec3(0.,1.,0.)));
                vec3 cu = normalize(cross(cf,cs));
                
                vec3 uuv = ro+cf*3. + uv.x*cs + uv.y*cu;
                
                vec3 rd = normalize(uuv-ro);
                
                vec4 col = rm(ro,rd);
                
                
                fragColor = col;
            }
            // -- End of Shadertoy code
                
                
            void main() {
                mainImage(gl_FragColor, gl_FragCoord.xy);
            }
          </script>
        <script>
            shaderWebBackground.shade({
                shaders: {
                    image: {
                        uniforms: {
                            iResolution: (gl, loc, ctx) => gl.uniform2f(loc, ctx.width, ctx.height),
                            iTime: (gl, loc) => gl.uniform1f(loc, performance.now() / 1000),
                        }
                    }
                }
            });
        </script>
        
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        <div id="main">
            <div id="controls">
                <input type="file" id="image-upload" accept="image/*">

                <div class="slider">
                    <span>Font Size</span>
                    <input id="font-slider" type="range" min="30" max="150" value="50">
                    <span id="font-slider-label">10px</span>
                </div>

                <textarea id="text-input" rows="4" cols="32"></textarea>
                
                <div class="slider">
                    <span>x:</span>
                    <input id="xpos" type="range" min="10" max="200" value="10">
                </div>
                <div class="slider">
                    <span>y:</span>
                    <input id="ypos" type="range" min="10" max="200" value="10">
                </div>
                
                <input id="save-button" class="button" type="button" value="Finish label">
                <input id="print-button" class="button" type="button" value="Print" disabled="true">
                
                <!--<button type="button" id="add-address">Add Address</button>-->
                <!--<div style="background-color: #b8deff; text-align: center; padding: 5px;" id="tempbutton">spawn image</div>-->
            </div>
            <canvas id="main-canvas" class="canvas-flexbox-destretch non-display-canvas"></canvas>
            <canvas id="font-canvas" class="canvas-flexbox-destretch non-display-canvas"></canvas>
            <canvas id="save-canvas" class="canvas-flexbox-destretch non-display-canvas"></canvas>
            <canvas id="display-canvas" class="canvas-flexbox-destretch"></canvas>
        </div>
        
        <!--<script src="jszip.min.js" async defer></script>-->
        <!--<script src="FileSaver.min.js" async defer></script>-->
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
        <script src="labelmaker.js"></script>
    </body>
</html>